    <button> <a id="instructionLink">Instruction</a></button>

    <div class="instruction-section" id="instructionSection">
        <div class="instruction-header">
            <h3><u> INSTRUCTIONS </u></h3>

            <!-- Add a container for the buttons -->
            <div class="button-container">
                <button class="add-btn" id="openModalBtn">
                    <img
                        src="/img/actualiser.png" />

                    Ajouter
                </button>

                <form action="" method="get">
                    <button class="update-btn" type="submit">
                        <img src="/img/actualiser.png" />
                        Actualiser
                    </button>
                </form>

                <button class="export-btn">
                    <img src="/img/actualiser.png" />
                    Exporter Excel
                </button>
            </div>
        </div>

        <div class="table-container">
            <table id="dataTable">
                <thead>
                    <tr>
                        <th></th>
                        <th></th>
                        <th></th>
                        <th></th>
                        <th></th>
                        <th></th>
                        <th>Code</th>
                        <th>Désignation</th>
                        <th>Cadence</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <?php foreach ($albums as $album): ?>
                        <tr data-id="<?= htmlspecialchars($album->code) ?>">
                            <td><button class="voir-btn"><i class="fa fa-eye"></i></button></td>
                            <td><button class="edit-btn"><i class="fa fa-pencil"></i></button></td>
                            <td><button class="delete-btn"><i class="fa fa-trash"></i></button></td>
                            <td><button class="immprimer-btn"><i class="fa fa-print"></i></button></td>
                            <td><button class="dupliquer-btn"><i class="fa fa-clone"></i></button></td>
                            <td><button> Details</button></td>
                            <td><?= htmlspecialchars($album->code) ?></td>
                            <td><?= htmlspecialchars($album->designation) ?></td>
                            <td><?= htmlspecialchars($album->cadence) ?></td>
                            <td><?= htmlspecialchars($album->description) ?></td>
                        </tr>
                    <?php endforeach; ?>

                </tbody>
            </table>
        </div>
    </div>

    <div id="myModal" class="modal">
        <div class="modal-content">
            <h3 id="modalTitle">Ajouter</h3>
            <hr />
            <form id="addItemForm">
                <div class="form-row">
                    <div class="input-container" style="flex: 2">
                        <label for="code">Code</label>
                        <input type="text" id="code" name="code" required />
                    </div>
                    <div class="input-container" style="flex: 3">
                        <label for="designation">Désignation</label>
                        <input type="text" id="designation" name="designation" required />
                    </div>
                </div>

                <label for="post">Poste de charge</label>
                <input type="text" id="post" name="post" required />

                <label for="description">Description</label>
                <textarea id="description" name="description" rows="4"></textarea>

                <div id="checkbox-group" class="checkbox-group-left">
                    <div class="checkbox-label">
                        <input type="checkbox" id="imprimer" name="imprimer" />
                        <label for="imprimer">Imprimer</label>
                    </div>
                    <div class="checkbox-label">
                        <input type="checkbox" id="interface" name="interface" />
                        <label for="interface">Interface</label>
                    </div>
                </div>
                <hr />
                <div class="modal-buttons">
                    <button class="close" type="button" id="closeModalBtn">
                        Annuler
                    </button>
                    <button type="submit">Valider</button>
                </div>
            </form>
        </div>
    </div>

    <link
        rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />
    <style>
        body {
            font-family: Arial, Helvetica, sans-serif;
        }


        .instruction-section h3 {
            text-transform: uppercase;
            display: inline-block;
            margin-right: 20px;
        }


        .table-container {
            margin-top: 20px;
            border-collapse: collapse;
            width: 100%;
        }

        .table-container table {
            width: 100%;
            border-collapse: collapse;
        }

        .table-container th,
        .table-container td {
            border: 1px solid black;
            padding: 8px;
            text-align: left;
        }

        th:nth-child(1),
        td:nth-child(1),
        th:nth-child(2),
        td:nth-child(2),
        th:nth-child(3),
        td:nth-child(3),
        th:nth-child(4),
        td:nth-child(4),
        th:nth-child(5),
        td:nth-child(5) {
            width: 10px;
        }

        th:nth-child(6),
        td:nth-child(6) {
            width: 30px;
        }

        .table-container th {
            background-color: #f8f4f4;
            color: #707279;
        }

        .table-container td {
            color: #292828;
        }

        /* Modal Styles */
        .modal {
            position: fixed;
            z-index: 1;
            /*sit on to of the page*/
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            background-color: rgb(0, 0, 0);
            background-color: rgba(0, 0, 0, 0.4);
            align-items: center;
            bottom: 0;
            justify-content: center;
            align-items: center;
            display: none;
            position: fixed;

            bottom: 0;
        }

        .modal-content {
            background-color: #fefefe;
            padding: 20px;
            border: 1px solid #888;
            width: 25%;
            height: 50%;
            overflow-y: scroll;
            box-sizing: border-box;
        }

        label {
            display: block;
            margin-bottom: 8px;
        }

        input,
        textarea {
            width: 95%;
            padding: 10px;
            margin-bottom: 12px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }

        #code {
            width: 75%;
        }

        #designation {
            width: 91%;
        }

        .form-row {
            display: flex;
            justify-content: space-between;
            gap: 1px;
        }

        .form-row .input-container {
            flex: 1;
        }

        button {
            padding: 10px;
            margin-top: 10px;
            cursor: pointer;
            border-radius: 2px;
            border: 1px solid white;
            background-color: #d4d2d3;
            color: #292828;
        }

        button:hover {
            background-color: #888;
        }

        .close {
            background-color: #5a6061;
            color: white;
            border: none;
        }

        .modal button[type="submit"] {
            background-color: #1c8ad9;
            color: white;
            border: 2px #1c8ad9;

            border-radius: 2px;
        }

        .modal-buttons {
            display: flex;
            justify-content: space-between;
            margin-left: 75%;
            border-radius: 5px;

        }

        #checkbox-group {
            padding: 15px;
            background-color: #f9f9f9;
            border: 1px solid #ccc;
            border-radius: 5px;
            margin-top: 10px;
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            width: 95%;
        }

        #checkbox-group div {
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }

        #checkbox-group input[type="checkbox"] {
            margin-right: 10px;
        }

        .checkbox-label {
            display: flex;
            align-items: center;
        }

        .checkbox-group-left {
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: flex-start;
        }

        .instruction-header {
            display: flex;
            align-items: center;
            justify-content: flex-start;
            margin-bottom: 20px;

        }

        .instruction-header h3 {
            margin-right: 20px;
            margin-left: 2px;
            transform: translateY(6px);
        }

        .button-container {
            width: 400px;
            height: 40px;
            background-color: #f8f4f4;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            font-size: 18px;
            font-family: Arial, sans-serif;
        }

        .button-container button {
            display: flex;
            align-items: center;
            background: none;
            border: none;
            color: #707279;
            font-size: 16px;
            gap: 8px;
            cursor: pointer;
            padding: 5px 10px;
            justify-content: center;
            transform: translateY(-5px);

        }

        .button-container button:hover {
            color: #292828;
        }

        .button-container button img {
            width: 20px;
            height: 20px;
            margin-right: 5px;
        }

        .export-btn {
            white-space: nowrap;
            width: auto;
            padding: 5px 10px;
        }
    </style>


    <script>
        document.getElementById("instructionSection").style.display = "none";

        const dataTable = document.getElementById("dataTable").getElementsByTagName("tbody")[0];
        const myModal = document.getElementById("myModal");
        const modalTitle = document.getElementById("modalTitle");
        const addItemForm = document.getElementById("addItemForm");
        const openModalBtn = document.getElementById("openModalBtn");
        const closeModalBtn = document.getElementById("closeModalBtn");
        const instructionLink = document.getElementById("instructionLink");
        let editRow = null;

        // Show instructions
        instructionLink.addEventListener("click", () => {
            document.getElementById("instructionSection").style.display = "block";
        });

        // Open modal for adding
        openModalBtn.addEventListener("click", () => {
            myModal.style.display = "flex";
            addItemForm.reset();
            modalTitle.textContent = "Ajouter";
            addItemForm.setAttribute("data-action", "add"); // Set action type to add
            document.querySelector('.modal-buttons button[type="submit"]').style.display = "block";

            // Enable inputs for adding
            document.getElementById("code").disabled = false;
            document.getElementById("designation").disabled = false;
            document.getElementById("description").disabled = false;
        });

        // Close modal
        closeModalBtn.addEventListener("click", () => {
            myModal.style.display = "none";
        });

        // Open modal for editing
        dataTable.addEventListener("click", (event) => {
            if (event.target.closest(".edit-btn")) {
                const row = event.target.closest("tr");
                const cells = row.cells;

                document.getElementById("code").value = cells[6].textContent;
                document.getElementById("designation").value = cells[7].textContent;
                document.getElementById("description").value = cells[9].textContent;

                modalTitle.textContent = "Modifier";
                myModal.style.display = "flex";

                editRow = row;
                addItemForm.setAttribute("data-action", "edit"); // Set action type to edit
                addItemForm.setAttribute("data-id", row.getAttribute("data-id"));

                // Enable inputs for editing
                document.getElementById("code").disabled = false;
                document.getElementById("designation").disabled = false;
                document.getElementById("description").disabled = false;

                // Ensure the submit button is visible when in "edit" mode
                document.querySelector('.modal-buttons button[type="submit"]').style.display = "block";
            }

            if (event.target.closest(".voir-btn")) {
                const row = event.target.closest("tr");
                const cells = row.cells;

                modalTitle.textContent = "Voir";
                document.getElementById("code").value = cells[6].textContent;
                document.getElementById("designation").value = cells[7].textContent;
                document.getElementById("description").value = cells[9].textContent;

                // Disable inputs for viewing only
                document.getElementById("code").disabled = true;
                document.getElementById("designation").disabled = true;
                document.getElementById("description").disabled = true;

                // Hide the submit button for "Voir"
                document.querySelector('.modal-buttons button[type="submit"]').style.display = "none";

                myModal.style.display = "flex";
            }
        });

        // Form submit event
        addItemForm.addEventListener("submit", (e) => {
            e.preventDefault();

            const action = addItemForm.getAttribute("data-action");
            const albumId = addItemForm.getAttribute("data-id");
            const code = document.getElementById("code").value;
            const designation = document.getElementById("designation").value;
            const description = document.getElementById("description").value;

            if (action === "add") {
                // Adding button
                fetch("/album/add", {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json"
                        },
                        body: JSON.stringify({
                            action: "add",
                            code,
                            designation,
                            description
                        })
                    })
                    .then(response => response.json())
                    .then(data => {
                        if (data.success) {
                            alert("Instruction added successfully!");

                            const newRow = dataTable.insertRow();
                            newRow.setAttribute("data-id", code);
                            newRow.innerHTML = `
                    <td><button class="voir-btn"><i class="fa fa-eye"></i></button></td>
                    <td><button class="edit-btn"><i class="fa fa-pencil"></i></button></td>
                    <td><button class="delete-btn"><i class="fa fa-trash"></i></button></td>
                    <td><button class="immprimer-btn"><i class="fa fa-print"></i></button></td>
                    <td><button class="dupliquer-btn"><i class="fa fa-clone"></i></button></td>
                    <td><button>Details</button></td>
                    <td>${code}</td>
                    <td>${designation}</td>
                    <td></td>
                    <td>${description}</td>
                    `;

                            // Attach event listeners for new "Voir" button
                            newRow.querySelector(".voir-btn").addEventListener("click", () => {
                                modalTitle.textContent = "Voir";
                                const cells = newRow.cells;
                                document.getElementById("code").value = cells[6].textContent;
                                document.getElementById("designation").value = cells[7].textContent;
                                document.getElementById("description").value = cells[9].textContent;

                                // Disable inputs for viewing only
                                document.getElementById("code").disabled = true;
                                document.getElementById("designation").disabled = true;
                                document.getElementById("description").disabled = true;

                                // Hide the submit button for "Voir"
                                document.querySelector('.modal-buttons button[type="submit"]').style.display = "none";

                                myModal.style.display = "flex";
                            });

                            myModal.style.display = "none";
                        } else {
                            alert("Error adding instruction: " + data.message);
                        }
                    })
                    .catch(error => alert("An error occurred while adding the instruction."));
            }

            if (action === "edit" && albumId) {
                // Editing instruction
                fetch("/album/edit", {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json"
                        },
                        body: JSON.stringify({
                            action: "edit",
                            code,
                            designation,
                            description
                        })
                    })
                    .then(response => response.json())
                    .then(data => {
                        if (data.success) {
                            alert("Instruction updated successfully!");
                            const cells = editRow.cells;
                            cells[6].textContent = code;
                            cells[7].textContent = designation;
                            cells[9].textContent = description;
                            myModal.style.display = "none";
                        } else {
                            alert("Error updating instruction: " + data.message);
                        }
                    })
                    .catch(error => alert("An error occurred while updating the instruction."));
            }
        });
        // delete button 
        document.getElementById("dataTable").addEventListener("click", (event) => {
            // Check if the clicked target is a delete button
            const deleteButton = event.target.closest(".delete-btn");

            if (deleteButton) {
                const row = deleteButton.closest("tr"); // Get the row that the delete button is in
                const code = row.getAttribute("data-id");

                console.log("Delete button clicked for album code:", code);

                if (!code) {
                    alert("Album code is missing!");
                    return; // Exit if no code is found
                }

                if (confirm("Do you want to delete the album?")) {
                    fetch("/album/delete", {
                            method: "POST",
                            headers: {
                                "Content-Type": "application/json"
                            },
                            body: JSON.stringify({
                                action: "delete",
                                code: code // Send the album code
                            })
                        })
                        .then(response => {
                            console.log("Delete response status:", response.status);
                            return response.json();
                        })
                        .then(data => {
                            console.log("Delete response:", data);

                            if (data.success) {
                                alert("Album deleted successfully!");
                                row.remove(); // Remove the row from the table
                            } else {
                                alert("An error occurred during deletion: " + data.message);
                            }
                        })
                        .catch(error => {
                            console.error("Error during deletion:", error);
                            alert("An error occurred during deletion.");
                        });
                }
            }
        });
        // Duplicate button
        dataTable.addEventListener("click", (event) => {
            if (event.target.closest(".dupliquer-btn")) {
                const row = event.target.closest("tr");
                const code = row.getAttribute("data-id"); // Get the album code

                if (!code) {
                    alert("Album code is missing!");
                    return; // Exit if there is no code 
                }

                fetch("/album/duplicate", {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json"
                        },
                        body: JSON.stringify({
                            code: code // Send the album code to duplicate
                        })
                    })
                    .then(response => response.json())
                    .then(data => {
                        if (data.success) {
                            alert("Album duplicated successfully!");

                            const newRow = dataTable.insertRow();
                            newRow.setAttribute("data-id", data.newCode);
                            newRow.innerHTML = `
                        <td><button class="voir-btn"><i class="fa fa-eye"></i></button></td>
                        <td><button class="edit-btn"><i class="fa fa-pencil"></i></button></td>
                        <td><button class="delete-btn"><i class="fa fa-trash"></i></button></td>
                        <td><button class="immprimer-btn"><i class="fa fa-print"></i></button></td>
                        <td><button class="dupliquer-btn"><i class="fa fa-clone"></i></button></td>
                        <td><button>Details</button></td>
                        <td>${data.newCode}</td>
                        <td>${data.newDesignation}</td>
                        <td></td>
                        <td>${data.newDescription}</td>
                    `;
                        } else {
                            alert("Error duplicating album: " + data.message);
                        }
                    })
                    .catch(error => alert("An error occurred while duplicating the album."));
            }
        });
    </script>